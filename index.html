<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Paginis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/svg+xml" href="/lib//images/viewer.svg" alt="icon svg">

  <!-- Flipbook StyleSheet -->
  <link href="lib/css/min.css" rel="stylesheet" type="text/css">
  <!-- Icons Stylesheet -->
  <link href="lib/css/themify-icons.min.css" rel="stylesheet" type="text/css">
  <!-- Font Awesome for GitHub icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Ensure the flipbook container takes up the full available height without scrolling */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    #flipbookContainer {
      height: 100%;
      overflow: hidden;
    }

    /* Styles for the audio/video container */
    #mediaContainer {
      width: 300px; /* Default width */
      height: 200px; /* Default height */
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #2F2D2F; /* Match the background color */
      border: 1px solid #444;
      position: fixed;
      bottom: 20px; /* Position at the bottom */
      right: 20px; /* Position at the right */
      z-index: 100; /* Ensure it's on top */
      resize: both; /* Allow resizing */
      overflow: hidden; /* Hide overflow when resizing */
    }

    iframe {
      width: 100%;
      height: 100%;
    }
  </style>

</head>

<body class="bg-gray-900 text-white">

  <!-- GitHub Button positioned at the top right -->
  <div class="fixed top-4 right-4 z-50">
    <a href="https://github.com/ibra-kdbra/Paginis" target="_blank" class="flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg shadow-md hover:bg-gray-500 transition duration-200">
      <i class="fab fa-github mr-2"></i> <!-- GitHub Icon -->
      GitHub Repository
    </a>
  </div>

  <!-- Button to toggle the input panel visibility -->
  <div class="fixed bottom-4 left-4 z-50">
    <button id="togglePanelBtn" class="px-4 py-2 bg-green-500 text-white rounded-lg shadow-md">Hide Options</button>
  </div>

  <!-- Input panel to choose PDF source and load the PDF -->
  <div id="inputPanel" class="fixed bottom-0 left-0 w-full sm:w-96 p-4 bg-gray-800 text-white rounded-t-lg shadow-lg z-40">
    <!-- Dropdown to select between URL or local PDF -->
    <div class="flex justify-center mb-4">
      <select id="pdfSource" class="px-4 py-2 border border-gray-400 rounded-lg bg-white text-black w-full">
        <option value="local">Local PDF</option>
        <option value="url" selected>URL PDF</option>
      </select>
    </div>

    <!-- Input field for the PDF URL with updated text color -->
    <div id="urlInputField" class="flex justify-center mb-4">
      <input id="pdfUrl" type="text" placeholder="Enter PDF URL" 
             class="px-4 py-2 border border-gray-400 rounded-lg w-full bg-gray-800 text-gray-300 placeholder-gray-500">
    </div>

    <!-- Input field for the local PDF file -->
    <div id="fileInputField" class="hidden flex justify-center mb-4">
      <input id="pdfFile" type="file" accept="application/pdf" 
             class="px-4 py-2 border border-gray-400 rounded-lg w-full">
    </div>

    <!-- YouTube Playlist input -->
    <div class="flex justify-center mb-4">
      <input id="youtubeUrl" type="text" placeholder="Enter YouTube Playlist URL" 
             class="px-4 py-2 border border-gray-400 rounded-lg w-full bg-gray-800 text-gray-300 placeholder-gray-500">
    </div>

    <!-- Button to load the PDF or YouTube playlist -->
    <div class="flex justify-end">
      <button id="loadPdfBtn" class="px-3 py-2 bg-blue-500 text-white rounded-lg">Load PDF</button>
      <button id="loadYoutubeBtn" class="px-3 py-2 bg-red-500 text-white rounded-lg ml-2">Load YouTube</button>
    </div>
  </div>

  <!-- Container where the flipbook will be displayed -->
  <div id="flipbookContainer" class="h-screen w-full"></div>

  <!-- Container for the YouTube player -->
  <div id="mediaContainer" class="hidden">
    <iframe id="youtubePlayer" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </div>

  <!-- jQuery -->
  <script src="lib/js/libs/jquery.min.js" type="text/javascript"></script>
  <!-- Flipbook main Js file -->
  <script src="lib/js/dflip.min.js" type="text/javascript"></script>

  <!-- Main JavaScript code -->
  <script>
    jQuery(document).ready(function () {
      // Function to load the flipbook with the given PDF URL or file
      function loadFlipbook(pdfUrl) {
        var options = {
          height: "100%",
          duration: 700,
          backgroundColor: "#2F2D2F",
          // Disable page scroll when zooming
          zoomChange: function(isZoomed) {
            if (isZoomed) {
              $("body").css("overflow", "hidden");
            } else {
              $("body").css("overflow", "auto");
            }
          }
        };
        
        // Remove any existing flipbook instance to avoid duplications
        $("#flipbookContainer").empty();
        
        // Load the flipbook with the new PDF URL or blob
        $("#flipbookContainer").flipBook(pdfUrl, options);
      }

      // Default PDF URL
      var defaultPdf = 'https://utfs.io/f/aLxFAGHMpUDrHJi2MUlQmdfILsR4SYX9vh5tGa0AxUy31OwF';
      
      // Load the flipbook with the default PDF on page load
      loadFlipbook(defaultPdf);

      // Toggle the input panel visibility
      $("#togglePanelBtn").click(function() {
        $("#inputPanel").toggleClass("hidden");
        // Change button text based on panel visibility
        if ($("#inputPanel").hasClass("hidden")) {
          $("#togglePanelBtn").text("Show Options");
        } else {
          $("#togglePanelBtn").text("Hide Options");
        }
      });

      // Show/Hide input fields based on selection (URL or local)
      $("#pdfSource").change(function() {
        var selectedSource = $(this).val();
        if (selectedSource === "url") {
          $("#urlInputField").removeClass("hidden");
          $("#fileInputField").addClass("hidden");
        } else {
          $("#urlInputField").addClass("hidden");
          $("#fileInputField").removeClass("hidden");
        }
      });

      // Event listener for the button click to load PDF
      $("#loadPdfBtn").click(function() {
        var selectedSource = $("#pdfSource").val();
        
        if (selectedSource === "url") {
          // Get the value from the URL input field
          var newPdfUrl = $("#pdfUrl").val();
          
          if (newPdfUrl) {
            // Load the flipbook with the new PDF URL
            loadFlipbook(newPdfUrl);
          } else {
            alert("Please enter a valid PDF URL.");
          }
        } else if (selectedSource === "local") {
          // Get the local PDF file
          var fileInput = document.getElementById("pdfFile");
          var file = fileInput.files[0];
          
          if (file) {
            var fileUrl = URL.createObjectURL(file);
            loadFlipbook(fileUrl);
          } else {
            alert("Please select a valid PDF file.");
          }
        }
      });

      // Event listener for the button click to load YouTube playlist
      $("#loadYoutubeBtn").click(function() {
        var youtubeUrl = $("#youtubeUrl").val();
        if (youtubeUrl) {
          // Extract playlist ID from the URL
          var playlistId = youtubeUrl.split("list=")[1].split("&")[0];
          var embedUrl = `https://www.youtube.com/embed/videoseries?list=${playlistId}`;
          $("#youtubePlayer").attr("src", embedUrl);
          $("#mediaContainer").removeClass("hidden"); // Show the media container
        } else {
          alert("Please enter a valid YouTube playlist URL.");
        }
      });
    });
  </script>

</body>
</html>
